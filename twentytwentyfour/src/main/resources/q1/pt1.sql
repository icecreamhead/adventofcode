drop table if exists q1;
create table q1
(
    part smallint not null,
    l    bigint   not null,
    r    bigint   not null
);

INSERT INTO q1
VALUES (1, 3, 4),
       (1, 4, 3),
       (1, 2, 5),
       (1, 1, 3),
       (1, 3, 9),
       (1, 3, 3);

WITH ls (rn, l) AS (SELECT row_number() over (order by l), l
                    FROM q1
                    WHERE part = 1
                    ORDER BY l),
     rs (rn, r) AS (SELECT row_number() over (order by r), r
                    FROM q1
                    WHERE part = 1
                    ORDER BY r)
SELECT sum(abs(l - r))
FROM ls
         JOIN rs USING (rn);

SELECT SUM(similarity)
FROM (SELECT l * COUNT(x.r) similarity
      FROM q1
               LEFT JOIN (select r
                          from q1
                          where part = 0) x ON q1.l = x.r
      WHERE part = 0
      GROUP BY l) foo;

insert into q1
values (0, 18102, 93258),
       (0, 34171, 50404),
       (0, 48236, 60718),
       (0, 10441, 41669),
       (0, 63428, 45329),
       (0, 42451, 56834),
       (0, 74881, 39407),
       (0, 32801, 36101),
       (0, 52771, 79895),
       (0, 41513, 78731),
       (0, 81076, 52363),
       (0, 87623, 35520),
       (0, 15259, 96330),
       (0, 57319, 78241),
       (0, 42758, 41144),
       (0, 80744, 20357),
       (0, 28199, 55267),
       (0, 22505, 35520),
       (0, 74707, 74819),
       (0, 67725, 96130),
       (0, 13883, 35520),
       (0, 87486, 55267),
       (0, 25070, 30977),
       (0, 10199, 74819),
       (0, 91803, 75066),
       (0, 60122, 78266),
       (0, 17884, 61488),
       (0, 41073, 81666),
       (0, 24778, 15223),
       (0, 46587, 87276),
       (0, 75477, 82771),
       (0, 78585, 59630),
       (0, 23143, 20028),
       (0, 67975, 13674),
       (0, 33304, 70802),
       (0, 19939, 50051),
       (0, 35520, 52616),
       (0, 73263, 19938),
       (0, 89352, 99541),
       (0, 65187, 80938),
       (0, 41347, 35520),
       (0, 64416, 57744),
       (0, 86648, 22827),
       (0, 91435, 47131),
       (0, 96712, 38412),
       (0, 89053, 76476),
       (0, 68596, 31155),
       (0, 22661, 30518),
       (0, 87094, 22104),
       (0, 10403, 46003),
       (0, 41029, 68410),
       (0, 62486, 54054),
       (0, 24752, 47138),
       (0, 59331, 80259),
       (0, 83839, 84471),
       (0, 19771, 87508),
       (0, 68258, 73947),
       (0, 69907, 93126),
       (0, 36611, 87565),
       (0, 69633, 35520),
       (0, 19461, 20361),
       (0, 43869, 86799),
       (0, 88115, 13167),
       (0, 27925, 21142),
       (0, 75724, 33150),
       (0, 14715, 66772),
       (0, 46237, 88588),
       (0, 22390, 57154),
       (0, 90584, 66789),
       (0, 89982, 55267),
       (0, 98196, 93258),
       (0, 83394, 28441),
       (0, 68840, 50490),
       (0, 21728, 36730),
       (0, 83742, 60945),
       (0, 43346, 38412),
       (0, 79097, 84471),
       (0, 13016, 35520),
       (0, 28401, 41164),
       (0, 18245, 81634),
       (0, 99352, 39461),
       (0, 33202, 36444),
       (0, 88303, 14489),
       (0, 95205, 90462),
       (0, 80929, 97718),
       (0, 18847, 78535),
       (0, 36538, 10273),
       (0, 40204, 76019),
       (0, 52395, 80344),
       (0, 62145, 55267),
       (0, 29945, 74391),
       (0, 99218, 14416),
       (0, 92009, 42686),
       (0, 83998, 36730),
       (0, 50338, 81796),
       (0, 43724, 90026),
       (0, 86537, 33172),
       (0, 89079, 44444),
       (0, 32728, 41669),
       (0, 60742, 67245),
       (0, 35894, 42369),
       (0, 66329, 16357),
       (0, 42434, 19057),
       (0, 65046, 13593),
       (0, 41778, 42363),
       (0, 62183, 46290),
       (0, 37564, 10310),
       (0, 46436, 94358),
       (0, 58111, 74819),
       (0, 13914, 85272),
       (0, 67992, 46429),
       (0, 42766, 46993),
       (0, 97620, 79909),
       (0, 12930, 36101),
       (0, 14208, 62020),
       (0, 41890, 36730),
       (0, 81680, 21444),
       (0, 84864, 64563),
       (0, 29905, 72690),
       (0, 35753, 52398),
       (0, 73868, 35520),
       (0, 17253, 29006),
       (0, 72538, 88588),
       (0, 77189, 89503),
       (0, 81736, 18206),
       (0, 33322, 31658),
       (0, 48157, 79144),
       (0, 28398, 45304),
       (0, 51735, 83365),
       (0, 42009, 59880),
       (0, 25466, 41416),
       (0, 52459, 99199),
       (0, 57747, 36730),
       (0, 12226, 12617),
       (0, 41445, 33884),
       (0, 15088, 42664),
       (0, 21076, 99403),
       (0, 24923, 36730),
       (0, 47057, 87695),
       (0, 14281, 76662),
       (0, 58163, 75603),
       (0, 41046, 88588),
       (0, 25315, 52616),
       (0, 88847, 31193),
       (0, 25550, 35520),
       (0, 37785, 54965),
       (0, 42166, 81663),
       (0, 36739, 55267),
       (0, 13289, 58788),
       (0, 95744, 62866),
       (0, 23230, 41669),
       (0, 89299, 88513),
       (0, 94591, 57796),
       (0, 19517, 78347),
       (0, 38689, 71550),
       (0, 55241, 41669),
       (0, 80752, 85442),
       (0, 24799, 84471),
       (0, 13063, 55267),
       (0, 27395, 80539),
       (0, 78086, 41669),
       (0, 49641, 13167),
       (0, 60112, 63395),
       (0, 57026, 15781),
       (0, 34007, 29172),
       (0, 49274, 72405),
       (0, 14926, 96924),
       (0, 54717, 58045),
       (0, 16315, 22728),
       (0, 90753, 82631),
       (0, 99446, 13167),
       (0, 51171, 81263),
       (0, 65577, 51430),
       (0, 59152, 40932),
       (0, 98558, 41284),
       (0, 60772, 88588),
       (0, 89469, 93258),
       (0, 78257, 51498),
       (0, 17794, 63128),
       (0, 17963, 99564),
       (0, 10250, 12980),
       (0, 11455, 64655),
       (0, 89464, 78241),
       (0, 68825, 20389),
       (0, 18793, 81458),
       (0, 78236, 41669),
       (0, 54490, 94531),
       (0, 16188, 51392),
       (0, 17889, 41669),
       (0, 88466, 55267),
       (0, 30083, 84471),
       (0, 83012, 57306),
       (0, 70675, 81796),
       (0, 13694, 84854),
       (0, 58909, 38592),
       (0, 40234, 94238),
       (0, 51671, 81883),
       (0, 91196, 49891),
       (0, 86378, 92193),
       (0, 81435, 83848),
       (0, 52846, 38940),
       (0, 96254, 85424),
       (0, 28810, 35155),
       (0, 57295, 68573),
       (0, 56262, 94606),
       (0, 70230, 29354),
       (0, 22599, 10175),
       (0, 42130, 30343),
       (0, 52701, 99403),
       (0, 62915, 12166),
       (0, 76676, 88588),
       (0, 92756, 55926),
       (0, 85607, 84471),
       (0, 59730, 67890),
       (0, 32152, 56550),
       (0, 83584, 12212),
       (0, 91305, 52052),
       (0, 92411, 62866),
       (0, 30000, 24317),
       (0, 48046, 39809),
       (0, 53235, 93258),
       (0, 58381, 30343),
       (0, 81243, 39857),
       (0, 46414, 37480),
       (0, 14203, 19491),
       (0, 94671, 53889),
       (0, 25932, 74714),
       (0, 15761, 95661),
       (0, 41032, 87276),
       (0, 95383, 12977),
       (0, 63041, 37164),
       (0, 62397, 38420),
       (0, 31632, 80344),
       (0, 73259, 63756),
       (0, 39665, 53750),
       (0, 80475, 32801),
       (0, 71036, 88588),
       (0, 72272, 79144),
       (0, 60444, 94808),
       (0, 62938, 98520),
       (0, 91946, 39934),
       (0, 65936, 81849),
       (0, 46418, 56506),
       (0, 75068, 97162),
       (0, 39001, 52616),
       (0, 41161, 30343),
       (0, 15026, 35598),
       (0, 42469, 41669),
       (0, 56940, 80344),
       (0, 14981, 79323),
       (0, 18795, 70311),
       (0, 51498, 79144),
       (0, 18298, 39857),
       (0, 57977, 95908),
       (0, 99404, 90175),
       (0, 16709, 94746),
       (0, 52847, 17022),
       (0, 19595, 32739),
       (0, 75552, 54475),
       (0, 56206, 73676),
       (0, 21473, 79204),
       (0, 92226, 37522),
       (0, 77631, 41409),
       (0, 32460, 39212),
       (0, 68228, 89367),
       (0, 93156, 51665),
       (0, 43009, 54778),
       (0, 14468, 63363),
       (0, 38918, 43492),
       (0, 63144, 83443),
       (0, 64474, 99403),
       (0, 59151, 68155),
       (0, 74740, 84352),
       (0, 46043, 66174),
       (0, 19176, 79144),
       (0, 80639, 36730),
       (0, 12346, 18866),
       (0, 32789, 35520),
       (0, 30312, 13167),
       (0, 90241, 34021),
       (0, 61418, 95707),
       (0, 52839, 52960),
       (0, 59507, 11557),
       (0, 51774, 80344),
       (0, 72851, 31658),
       (0, 21231, 52129),
       (0, 17825, 67968),
       (0, 48685, 80344),
       (0, 90363, 14286),
       (0, 32135, 81656),
       (0, 89692, 93229),
       (0, 71792, 84471),
       (0, 24754, 91630),
       (0, 15559, 17945),
       (0, 73777, 62866),
       (0, 73826, 93258),
       (0, 61029, 10131),
       (0, 21893, 79844),
       (0, 72680, 80344),
       (0, 54635, 80344),
       (0, 46537, 96585),
       (0, 28015, 51978),
       (0, 80768, 99403),
       (0, 52593, 31658),
       (0, 15701, 83366),
       (0, 97543, 45838),
       (0, 33327, 55267),
       (0, 60326, 10669),
       (0, 71666, 68499),
       (0, 68900, 91751),
       (0, 27686, 40337),
       (0, 39616, 62866),
       (0, 51033, 37907),
       (0, 25015, 14676),
       (0, 41682, 19585),
       (0, 79008, 36730),
       (0, 49472, 47063),
       (0, 98674, 62202),
       (0, 33282, 84471),
       (0, 59585, 75619),
       (0, 86450, 58477),
       (0, 14432, 87276),
       (0, 67623, 18866),
       (0, 84033, 69700),
       (0, 13957, 40073),
       (0, 55400, 21005),
       (0, 13167, 36730),
       (0, 34835, 15933),
       (0, 71718, 58623),
       (0, 95411, 97681),
       (0, 57118, 94831),
       (0, 41944, 62866),
       (0, 88120, 62866),
       (0, 11752, 32137),
       (0, 85462, 36211),
       (0, 85424, 46228),
       (0, 79713, 80344),
       (0, 16019, 62866),
       (0, 17655, 38412),
       (0, 26672, 17352),
       (0, 82553, 76385),
       (0, 23188, 71537),
       (0, 56490, 39857),
       (0, 46951, 13167),
       (0, 85961, 13877),
       (0, 51560, 77830),
       (0, 94957, 52616),
       (0, 27650, 74995),
       (0, 70629, 73120),
       (0, 25129, 32171),
       (0, 62148, 48774),
       (0, 44331, 87276),
       (0, 69734, 37018),
       (0, 21661, 51261),
       (0, 13612, 82993),
       (0, 90689, 13167),
       (0, 92312, 86533),
       (0, 98598, 80344),
       (0, 68752, 41669),
       (0, 30190, 35520),
       (0, 36730, 50595),
       (0, 52267, 64296),
       (0, 59707, 65310),
       (0, 80349, 62885),
       (0, 63683, 45682),
       (0, 74727, 82966),
       (0, 86012, 81529),
       (0, 39964, 88805),
       (0, 16119, 69720),
       (0, 33146, 70138),
       (0, 90376, 97651),
       (0, 22904, 98429),
       (0, 87159, 29634),
       (0, 23078, 18154),
       (0, 23361, 32845),
       (0, 71970, 63128),
       (0, 10411, 92866),
       (0, 31178, 88588),
       (0, 50980, 27848),
       (0, 45078, 77661),
       (0, 91447, 42358),
       (0, 71418, 32868),
       (0, 76636, 78241),
       (0, 30598, 93258),
       (0, 28434, 38738),
       (0, 40660, 79275),
       (0, 62848, 99403),
       (0, 28084, 38612),
       (0, 12699, 59071),
       (0, 59263, 81796),
       (0, 26439, 62866),
       (0, 17391, 78241),
       (0, 93530, 45014),
       (0, 45542, 97173),
       (0, 69388, 13423),
       (0, 80066, 28361),
       (0, 63149, 95510),
       (0, 27861, 81796),
       (0, 62609, 28829),
       (0, 78241, 64755),
       (0, 98783, 53082),
       (0, 21987, 31658),
       (0, 31758, 18211),
       (0, 21749, 79144),
       (0, 70377, 52464),
       (0, 65877, 97679),
       (0, 74993, 57174),
       (0, 53846, 78241),
       (0, 67812, 39783),
       (0, 32323, 63362),
       (0, 18461, 91739),
       (0, 38165, 31920),
       (0, 80422, 39857),
       (0, 43219, 31658),
       (0, 84785, 30343),
       (0, 54985, 88562),
       (0, 18275, 62866),
       (0, 54638, 78780),
       (0, 76547, 55267),
       (0, 15874, 41010),
       (0, 86965, 36101),
       (0, 97038, 74819),
       (0, 13828, 44487),
       (0, 21733, 79144),
       (0, 84471, 16719),
       (0, 26596, 15857),
       (0, 16529, 28650),
       (0, 25443, 35348),
       (0, 15059, 43502),
       (0, 81770, 36730),
       (0, 81309, 78241),
       (0, 35589, 69602),
       (0, 94630, 35179),
       (0, 53197, 76827),
       (0, 29523, 66364),
       (0, 46055, 30993),
       (0, 85203, 60814),
       (0, 39329, 53071),
       (0, 18663, 32233),
       (0, 50108, 99922),
       (0, 41019, 98673),
       (0, 89169, 76809),
       (0, 93556, 52782),
       (0, 69891, 54164),
       (0, 40270, 51225),
       (0, 82965, 46304),
       (0, 22455, 40010),
       (0, 41669, 32801),
       (0, 71630, 15002),
       (0, 48390, 61558),
       (0, 44783, 78241),
       (0, 59867, 32801),
       (0, 36112, 31658),
       (0, 81101, 91237),
       (0, 54551, 96109),
       (0, 20993, 92021),
       (0, 50680, 38412),
       (0, 63128, 84471),
       (0, 94509, 80344),
       (0, 10577, 99239),
       (0, 25724, 84471),
       (0, 17317, 20799),
       (0, 39300, 76645),
       (0, 76421, 67643),
       (0, 43817, 20959),
       (0, 75711, 58027),
       (0, 34480, 35520),
       (0, 64585, 64739),
       (0, 64685, 99403),
       (0, 43062, 58999),
       (0, 81760, 88588),
       (0, 63083, 40045),
       (0, 39425, 36730),
       (0, 17622, 80859),
       (0, 64617, 36051),
       (0, 59190, 85424),
       (0, 81175, 97509),
       (0, 93869, 51498),
       (0, 62866, 61413),
       (0, 26396, 71626),
       (0, 87276, 98001),
       (0, 79144, 48463),
       (0, 23812, 31658),
       (0, 31923, 47911),
       (0, 87102, 81796),
       (0, 40295, 85346),
       (0, 92002, 66371),
       (0, 62557, 65288),
       (0, 73197, 53046),
       (0, 68891, 80787),
       (0, 39756, 37172),
       (0, 19915, 60878),
       (0, 43089, 32558),
       (0, 30343, 31658),
       (0, 50332, 66707),
       (0, 26000, 58109),
       (0, 67720, 82142),
       (0, 41227, 56943),
       (0, 97647, 47831),
       (0, 76020, 38412),
       (0, 40485, 84471),
       (0, 16962, 53016),
       (0, 30066, 28740),
       (0, 31118, 54102),
       (0, 41928, 99913),
       (0, 82656, 38412),
       (0, 94155, 34933),
       (0, 52515, 48131),
       (0, 48519, 45948),
       (0, 64922, 51902),
       (0, 73451, 81796),
       (0, 31917, 93734),
       (0, 96992, 56765),
       (0, 60790, 48526),
       (0, 68218, 75199),
       (0, 80344, 59642),
       (0, 94057, 47998),
       (0, 74830, 99403),
       (0, 70462, 56217),
       (0, 76371, 18624),
       (0, 56899, 90796),
       (0, 92898, 66333),
       (0, 34979, 72161),
       (0, 37736, 80344),
       (0, 41607, 32801),
       (0, 48181, 41716),
       (0, 72333, 26215),
       (0, 13666, 78112),
       (0, 91781, 85424),
       (0, 77373, 83784),
       (0, 94719, 94693),
       (0, 65491, 41669),
       (0, 88464, 47980),
       (0, 98595, 56821),
       (0, 16665, 57249),
       (0, 42861, 81712),
       (0, 38767, 65492),
       (0, 31642, 39581),
       (0, 54565, 86820),
       (0, 51346, 74706),
       (0, 38258, 81796),
       (0, 35980, 77859),
       (0, 13015, 61175),
       (0, 79811, 14561),
       (0, 29887, 12736),
       (0, 48972, 31658),
       (0, 43907, 40337),
       (0, 15478, 45373),
       (0, 97895, 52030),
       (0, 93779, 15247),
       (0, 19906, 88588),
       (0, 69778, 98196),
       (0, 66203, 63897),
       (0, 91035, 39857),
       (0, 27450, 63128),
       (0, 11710, 77533),
       (0, 61760, 31658),
       (0, 50614, 74819),
       (0, 89099, 87276),
       (0, 75125, 46470),
       (0, 55904, 39857),
       (0, 76167, 37911),
       (0, 94908, 47677),
       (0, 58478, 18866),
       (0, 20475, 37504),
       (0, 21737, 13167),
       (0, 90464, 99403),
       (0, 12941, 84669),
       (0, 48793, 62866),
       (0, 60186, 84471),
       (0, 11894, 39857),
       (0, 55293, 21637),
       (0, 33993, 76974),
       (0, 47080, 64256),
       (0, 73306, 62866),
       (0, 95473, 74936),
       (0, 35272, 59929),
       (0, 20187, 36730),
       (0, 48764, 59657),
       (0, 65430, 16092),
       (0, 79522, 28419),
       (0, 98586, 21238),
       (0, 11131, 97814),
       (0, 15190, 32801),
       (0, 14978, 39857),
       (0, 83286, 78490),
       (0, 40748, 81839),
       (0, 25325, 20040),
       (0, 24813, 58230),
       (0, 52110, 79030),
       (0, 75599, 95523),
       (0, 23138, 63833),
       (0, 63416, 65152),
       (0, 13853, 98184),
       (0, 60874, 80344),
       (0, 32281, 88588),
       (0, 80353, 72102),
       (0, 24683, 84471),
       (0, 42421, 38412),
       (0, 75909, 86850),
       (0, 22940, 36074),
       (0, 80544, 96507),
       (0, 62292, 58866),
       (0, 98462, 38182),
       (0, 46560, 56050),
       (0, 87289, 79144),
       (0, 88955, 15573),
       (0, 70992, 25439),
       (0, 81256, 38412),
       (0, 28446, 29484),
       (0, 83121, 95224),
       (0, 16108, 74352),
       (0, 34016, 37646),
       (0, 55211, 29561),
       (0, 20806, 87737),
       (0, 17271, 99403),
       (0, 35249, 76966),
       (0, 25159, 67894),
       (0, 40337, 58440),
       (0, 60006, 32338),
       (0, 60866, 38412),
       (0, 66540, 93258),
       (0, 90000, 58211),
       (0, 57957, 38113),
       (0, 54883, 80382),
       (0, 65202, 41669),
       (0, 56318, 22865),
       (0, 43827, 39813),
       (0, 81395, 40970),
       (0, 69790, 86084),
       (0, 17754, 55267),
       (0, 92786, 31658),
       (0, 98085, 88588),
       (0, 50334, 48963),
       (0, 35482, 58393),
       (0, 32883, 70992),
       (0, 62378, 14433),
       (0, 99609, 73135),
       (0, 35356, 36730),
       (0, 78375, 68903),
       (0, 37024, 13132),
       (0, 24204, 27308),
       (0, 72637, 38412),
       (0, 17428, 58766),
       (0, 80886, 18866),
       (0, 66117, 59583),
       (0, 77402, 72213),
       (0, 66620, 23574),
       (0, 37470, 26120),
       (0, 56642, 97207),
       (0, 16039, 99994),
       (0, 23520, 59100),
       (0, 39995, 75647),
       (0, 31430, 77373),
       (0, 59277, 16018),
       (0, 77197, 21617),
       (0, 93312, 84197),
       (0, 81972, 60483),
       (0, 99910, 79880),
       (0, 83510, 34604),
       (0, 52934, 99403),
       (0, 60313, 32544),
       (0, 86206, 62733),
       (0, 32957, 53708),
       (0, 18748, 59570),
       (0, 34408, 63137),
       (0, 64561, 95075),
       (0, 89324, 88588),
       (0, 86562, 99403),
       (0, 34014, 98669),
       (0, 52477, 54060),
       (0, 82112, 91468),
       (0, 46837, 51376),
       (0, 42855, 89033),
       (0, 76285, 10788),
       (0, 48498, 11016),
       (0, 87628, 95461),
       (0, 25039, 23870),
       (0, 44726, 84471),
       (0, 36316, 17593),
       (0, 55475, 12512),
       (0, 40885, 61324),
       (0, 55982, 41669),
       (0, 28353, 93258),
       (0, 90070, 87664),
       (0, 92571, 50972),
       (0, 64040, 77373),
       (0, 66045, 44321),
       (0, 76075, 47585),
       (0, 69898, 35520),
       (0, 31897, 78241),
       (0, 45288, 77373),
       (0, 61402, 40079),
       (0, 43939, 79476),
       (0, 83915, 87612),
       (0, 51714, 70302),
       (0, 55728, 61718),
       (0, 19212, 48853),
       (0, 50471, 15323),
       (0, 11253, 36730),
       (0, 36282, 61657),
       (0, 99765, 88588),
       (0, 40255, 84064),
       (0, 65591, 31658),
       (0, 88588, 30358),
       (0, 53096, 62672),
       (0, 32485, 52616),
       (0, 90637, 35520),
       (0, 23957, 55267),
       (0, 15301, 74819),
       (0, 99304, 38412),
       (0, 42581, 99633),
       (0, 89403, 78241),
       (0, 88697, 46405),
       (0, 23646, 81942),
       (0, 82798, 41669),
       (0, 19417, 72825),
       (0, 99035, 54991),
       (0, 99372, 77622),
       (0, 49134, 11067),
       (0, 41732, 49561),
       (0, 69058, 51302),
       (0, 85817, 52817),
       (0, 80628, 47979),
       (0, 98869, 18345),
       (0, 21540, 44446),
       (0, 36075, 62399),
       (0, 74841, 16533),
       (0, 29826, 68948),
       (0, 74966, 33155),
       (0, 76789, 33664),
       (0, 42909, 76884),
       (0, 61686, 93258),
       (0, 65851, 98787),
       (0, 38529, 64090),
       (0, 64968, 58698),
       (0, 99647, 70935),
       (0, 49851, 13167),
       (0, 88523, 38412),
       (0, 92200, 35520),
       (0, 21926, 55267),
       (0, 85918, 78241),
       (0, 35092, 80344),
       (0, 39857, 33948),
       (0, 80393, 59217),
       (0, 97911, 43227),
       (0, 90571, 35520),
       (0, 48736, 83686),
       (0, 77924, 63128),
       (0, 18866, 80344),
       (0, 21299, 74597),
       (0, 81796, 45742),
       (0, 93562, 96860),
       (0, 89376, 36730),
       (0, 68027, 75225),
       (0, 13032, 79144),
       (0, 28892, 57468),
       (0, 96012, 72691),
       (0, 96357, 90025),
       (0, 93590, 76769),
       (0, 39169, 81796),
       (0, 69505, 83140),
       (0, 27406, 79144),
       (0, 45575, 25412),
       (0, 10640, 69420),
       (0, 42859, 67773),
       (0, 54319, 76647),
       (0, 36900, 89641),
       (0, 16622, 73504),
       (0, 55267, 10781),
       (0, 60719, 75932),
       (0, 63099, 36730),
       (0, 14798, 31658),
       (0, 89944, 22601),
       (0, 40221, 55267),
       (0, 75498, 35601),
       (0, 91475, 36563),
       (0, 23362, 39524),
       (0, 56739, 81796),
       (0, 57452, 80344),
       (0, 60950, 97510),
       (0, 78516, 99403),
       (0, 27941, 62443),
       (0, 27521, 66529),
       (0, 33707, 88588),
       (0, 93324, 91799),
       (0, 57954, 78745),
       (0, 10142, 96525),
       (0, 93400, 79144),
       (0, 10246, 51708),
       (0, 96780, 80879),
       (0, 90160, 28886),
       (0, 75452, 68015),
       (0, 51405, 30788),
       (0, 30558, 43844),
       (0, 80443, 56573),
       (0, 53073, 55181),
       (0, 23213, 60714),
       (0, 86395, 98419),
       (0, 26118, 38412),
       (0, 77828, 81796),
       (0, 83431, 19529),
       (0, 66085, 56790),
       (0, 87013, 80344),
       (0, 78095, 27229),
       (0, 92609, 32801),
       (0, 97658, 96068),
       (0, 97452, 49425),
       (0, 63195, 95504),
       (0, 22526, 79144),
       (0, 40153, 79144),
       (0, 77603, 88145),
       (0, 21804, 26067),
       (0, 70021, 27010),
       (0, 39030, 20686),
       (0, 44696, 30343),
       (0, 98142, 54162),
       (0, 18276, 69052),
       (0, 61036, 14279),
       (0, 89542, 91528),
       (0, 36218, 99403),
       (0, 59135, 87980),
       (0, 44366, 61548),
       (0, 73468, 40559),
       (0, 30939, 26766),
       (0, 66589, 83054),
       (0, 39929, 63975),
       (0, 25239, 79144),
       (0, 74819, 40299),
       (0, 77393, 87276),
       (0, 89793, 74480),
       (0, 70491, 56646),
       (0, 13636, 99403),
       (0, 58152, 87276),
       (0, 30693, 19897),
       (0, 31134, 61607),
       (0, 12324, 35941),
       (0, 67104, 22474),
       (0, 89552, 84471),
       (0, 96869, 36730),
       (0, 61641, 42507),
       (0, 92835, 28786),
       (0, 51442, 41669),
       (0, 40162, 84338),
       (0, 92491, 16076),
       (0, 11753, 35520),
       (0, 95247, 79627),
       (0, 11256, 30343),
       (0, 93258, 41669),
       (0, 24504, 25813),
       (0, 85713, 41965),
       (0, 19158, 81796),
       (0, 50458, 41669),
       (0, 48386, 22205),
       (0, 68720, 90932),
       (0, 36101, 79144),
       (0, 57165, 78241),
       (0, 22469, 31658),
       (0, 99737, 14211),
       (0, 58884, 65158),
       (0, 29461, 98196),
       (0, 86864, 72295),
       (0, 91962, 77373),
       (0, 93672, 51538),
       (0, 89453, 83913),
       (0, 86350, 90636),
       (0, 42288, 98263),
       (0, 17267, 18583),
       (0, 30518, 55555),
       (0, 76868, 62866),
       (0, 55662, 44542),
       (0, 31658, 98196),
       (0, 99589, 31658),
       (0, 64736, 36101),
       (0, 16281, 62886),
       (0, 32687, 66131),
       (0, 77273, 83572),
       (0, 52616, 71835),
       (0, 35719, 12817),
       (0, 87282, 36101),
       (0, 49495, 17763),
       (0, 41116, 56436),
       (0, 65977, 31658),
       (0, 87148, 66523),
       (0, 71950, 99639),
       (0, 93432, 41570),
       (0, 47256, 24165),
       (0, 60388, 58593),
       (0, 52721, 87348),
       (0, 46321, 27970),
       (0, 31533, 64362),
       (0, 82098, 35520),
       (0, 60520, 98196),
       (0, 62425, 65803),
       (0, 90692, 57775),
       (0, 29160, 99403),
       (0, 28072, 65721),
       (0, 29207, 40337),
       (0, 96928, 11960),
       (0, 88074, 55022),
       (0, 11262, 31658),
       (0, 70439, 12630),
       (0, 46426, 40192),
       (0, 97124, 96336),
       (0, 97733, 79144),
       (0, 60902, 82128),
       (0, 20406, 18866),
       (0, 49465, 24075),
       (0, 92723, 84471),
       (0, 82785, 49899),
       (0, 85690, 84471),
       (0, 46301, 60801),
       (0, 70543, 39158),
       (0, 77397, 13167),
       (0, 78434, 89992),
       (0, 43358, 22650),
       (0, 38412, 60568),
       (0, 54633, 45527),
       (0, 27215, 93385),
       (0, 98736, 65619),
       (0, 12981, 48333),
       (0, 79201, 61358),
       (0, 71849, 25687),
       (0, 27785, 40337),
       (0, 57013, 13427),
       (0, 99403, 88588),
       (0, 22632, 26830),
       (0, 12033, 77373),
       (0, 66675, 16445),
       (0, 23066, 67354),
       (0, 80100, 31674),
       (0, 77822, 43658),
       (0, 70694, 18628),
       (0, 38583, 97566),
       (0, 29014, 39095),
       (0, 71974, 78640),
       (0, 44442, 94472),
       (0, 89670, 92693),
       (0, 58205, 52583),
       (0, 26610, 32340),
       (0, 50111, 36267),
       (0, 81769, 55267),
       (0, 80727, 15549),
       (0, 54969, 41669),
       (0, 88744, 81796),
       (0, 66642, 43640),
       (0, 38035, 81796),
       (0, 86110, 74184),
       (0, 74806, 38412),
       (0, 26849, 66673),
       (0, 27007, 93396),
       (0, 80555, 78794),
       (0, 64197, 32236),
       (0, 88661, 18331),
       (0, 16011, 32801),
       (0, 18265, 19847),
       (0, 73365, 46289),
       (0, 71259, 84471),
       (0, 53163, 80344),
       (0, 67421, 42238),
       (0, 61567, 39797),
       (0, 78176, 12791),
       (0, 68680, 99109),
       (0, 83969, 59805),
       (0, 99427, 65563),
       (0, 64286, 88588),
       (0, 69259, 49401),
       (0, 65989, 60112),
       (0, 74866, 55267),
       (0, 91571, 70365),
       (0, 61137, 72545),
       (0, 86810, 99342),
       (0, 91215, 74819),
       (0, 57984, 84471),
       (0, 64054, 45167),
       (0, 25371, 93258),
       (0, 56931, 97531),
       (0, 42448, 58600),
       (0, 77910, 41669),
       (0, 27234, 23987),
       (0, 55971, 67247),
       (0, 53910, 23754),
       (0, 59015, 16842),
       (0, 36568, 18866),
       (0, 93228, 92940),
       (0, 38858, 21883),
       (0, 37570, 41669),
       (0, 43634, 48654),
       (0, 61671, 36109),
       (0, 14455, 39324),
       (0, 69564, 61102),
       (0, 75007, 36730),
       (0, 83030, 35520),
       (0, 27889, 41669),
       (0, 90946, 41125),
       (0, 12614, 70263),
       (0, 61381, 18549),
       (0, 90763, 45873),
       (0, 13117, 44089),
       (0, 13363, 84471);

WITH ls (rn, l) AS (SELECT row_number() over (order by l), l
                    FROM q1
                    WHERE part = 0
                    ORDER BY l),
     rs (rn, r) AS (SELECT row_number() over (order by r), r
                    FROM q1
                    WHERE part = 0
                    ORDER BY r)
SELECT sum(abs(l - r))
FROM ls
         JOIN rs USING (rn);